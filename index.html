<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portfolio â€” Ghemra Manar</title>
  <link rel="stylesheet" href="css.css" />
  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-analytics.js";
    import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";
    import { getStorage, ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-storage.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCYhzsMUJX7Q7Zk58R28CS-8KZmZCdgrO4",
      authDomain: "portfolio-manar-ghemra.firebaseapp.com",
      projectId: "portfolio-manar-ghemra",
      storageBucket: "portfolio-manar-ghemra.appspot.com",
      messagingSenderId: "644022946013",
      appId: "1:644022946013:web:5465337e7d0f9546953334",
      measurementId: "G-6KJH3DTF6D"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);
    const storage = getStorage(app);

    async function fetchProjects() {
      const container = document.getElementById('project-list');
      if (!container) return;
      container.innerHTML = '';

      const q = query(collection(db, "projects"), orderBy("date", "desc"));
      const snapshot = await getDocs(q);

      snapshot.forEach(async doc => {
        const data = doc.data();
        const div = document.createElement('div');
        div.className = 'project-card';

        let buttonsHtml = '';

        if (data.files) {
          if (data.files.blend) {
            const url = await getDownloadURL(ref(storage, data.files.blend));
            buttonsHtml += `<a href="${url}" target="_blank" class="btn ghost" style="margin-right:8px;margin-bottom:8px">ğŸ“ TÃ©lÃ©charger Blender</a>`;
          }
          if (data.files.image) {
            const url = await getDownloadURL(ref(storage, data.files.image));
            buttonsHtml += `<a href="${url}" target="_blank" class="btn ghost" style="margin-right:8px;margin-bottom:8px">ğŸ–¼ TÃ©lÃ©charger Image</a>`;
          }
          if (data.files.video) {
            const url = await getDownloadURL(ref(storage, data.files.video));
            buttonsHtml += `<a href="${url}" target="_blank" class="btn ghost" style="margin-right:8px;margin-bottom:8px">ğŸ¬ TÃ©lÃ©charger VidÃ©o</a>`;
          }
        }

        div.innerHTML = `
          <h3 style="color:var(--accent1);margin-bottom:8px">${data.title}</h3>
          <p style="margin-bottom:12px;color:var(--muted)">${data.desc}</p>
          <div style="margin-top:12px">
            ${buttonsHtml || '<p class="muted">Aucun fichier disponible</p>'}
          </div>
        `;
        container.appendChild(div);
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      fetchProjects();
      setupActions();
      revealOnScroll();
      window.addEventListener('scroll', revealOnScroll);
    });

    window.fetchProjects = fetchProjects; // si besoin Ù„Ù„ÙˆØµÙˆÙ„ Ù…Ù† js.js
  </script>
</head>
<body>
<!-- ÙƒÙ„ Ø´ÙŠØ¡ ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ -->
<script src="js.js"></script>
</body>
</html>
